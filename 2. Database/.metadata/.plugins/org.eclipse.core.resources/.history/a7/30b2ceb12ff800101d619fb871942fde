SELECT * FROM employees
ORDER BY birth_date DESC;

SELECT * FROM titles
ORDER BY to_date DESC;


SELECT max(salary) FROM salaries s ;
SELECT min(salary) FROM salaries s;
SELECT avg(salary) FROM salaries s;
SELECT sum(salary) FROM salaries s;
SELECT count(*) FROM salaries;

SELECT count(*) AS '직원 수' FROM employees;

-- titles 테이블에서 title이 Engineer인 직원의 수를 조회하세요.
SELECT count(*) FROM titles
WHERE title = 'engineer';

-- employees 테이블에서 입사일이 1965년 1월 1일 이후인 직원의 수를 조회하세요
SELECT count(*) FROM employees
WHERE hire_date > '1965-01-01';

-- employees 테이블에서 emp_no가 가장 낮은 직원과 가장 높은 직원을 조회하세요
SELECT min(emp_no), max(emp_no) FROM employees;

SELECT min(emp_no) FROM employees;


SELECT max(emp_no), first_name, birth_date FROM employees
GROUP BY first_name, birth_date;

-- 부서별 직원 수 구하기
--  - 부서 번호(dept_no) 조회
SELECT count(*), dept_no FROM dept_emp
GROUP BY dept_no;

-- employees 테이블에서 성별 직원 수를 구하세요.
--  성별 : gender
--  직원수 (별칭 : “cnt”)
SELECT count(*), gender FROM employees
GROUP BY gender;

-- titles 테이블에서 직무별 직원 수를 구하세요.
--  직무 : title
--  직원 수 (별칭 : “직원 수”)
--  직무별 내림차순으로 정렬하여 조회하세요.
SELECT count(*), title FROM titles
GROUP BY title
ORDER BY title DESC;


SELECT count(*), title FROM titles
GROUP BY title
HAVING count(*) >= 100000
ORDER BY title DESC;


-- dept_emp에서 직원 수가 5만 이상인 부서만 조회
SELECT count(*), dept_no FROM dept_emp
GROUP BY dept_no
HAVING count(*) >= 50000;


-- 현재 재직중인 직원들 중 직무별 직원 수가 200명 미만인 직무만 조회
-- to_date가 9999-01-01이 재직중
SELECT title, count(*) FROM titles
WHERE to_date = '9999-01-01'
GROUP BY title
HAVING count(*) < 200
ORDER BY title desc;

SELECT hire_date, hire_date
FROM employees
GROUP BY hire_date, hire_date;
HAVING COUNT(*) >= 10000;


SELECT * 
FROM departments d
LEFT JOIN dept_manager dm
ON d.dept_no = dm.dept_no ;


SELECT * 
FROM dept_manager dm
RIGHT JOIN departments d 
ON dm.dept_no = d.dept_no;















